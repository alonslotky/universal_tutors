{% extends "ui/layouts/base.html" %}

{% load fb_versions common_tags tutor_tags %}

{% block title %}{{person.get_full_name}}'s profile{% endblock %}
{% block body_class %}app student tutor-profile{% endblock %}

{% block content %}
  <section class="blue feature-box"><div class="inner">
  	{% if owner %}
    <h1>Your Profile <span>You are seen your own profile.</span></h1>	
	{% else %}
    <h1>Tutor Profile <span>Details on a specific tutor.</span></h1>
	{% endif %}
  </div></section>
  
      <div class="hide-on-phones">
      {% include 'profile/fragments/_timer.html' %}
      </div>
  
  <div class="row">
    <div class="two columns">
      <div class="row space">
	      <div class="profile-picture">
	        <img src="{% version profile.profile_image.path 'profile_image' %}" alt="{{person.get_full_name}}">
	        {% if profile.video %}
	        <a href="javascript:;" class="watch-video ir" data-reveal-id="modal-video" onclick="$('#video-frame').removeClass('hidden');">Watch Video</a>
	        {% endif %}
	      </div>
	  </div>
      <div class="row space">
      	{% with profile.get_completeness as completeness %}
        <label>Profile completeness</label>
	  	<div class="profile-completeness">
	  		<div class="bar" style="width: {{completeness}}%;"></div>
	  		<div class="value">{{ completeness }}%</div>
	  	</div>
	  	{% endwith %}
	  </div>
    </div>
    
    <div class="ten columns">
      <h2>{{person.get_full_name}}</h2>
      <h4>{{profile.date_of_birth|age}}, {{profile.get_gender_display}}</h4>
      <p>&nbsp;</p>
      <div class="row">
        <div class="nine columns">
          <div class="row">
            <div class="six columns">

              {% if profile.about %}
              <label>Description</label>
              <p>{{profile.about}}</p>
              {% endif %}
              	
              <label>Qualifications</label>
              <ul class="tutor-qualifications-list">
                {% for item in person.qualifications.all %}
	                {% if item.document %}
	                <li><a class="open" href="{{item.document.url}}" target="blank">{{item.qualification}}</a></li>
                	{% else %}
	                <li>{{item.qualification}}</li>                	
                	{% endif %}
                {% empty %}
	                <li>No qualifications</li>                	                
                {% endfor %}
              </ul>

              <label>Webcam</label>
              <ul class="tutor-qualifications-list">
				{% if profile.webcam %}Yes{% else %}No{% endif %}
              </ul>
            </div>
            
            {% with person.subjects.all as subjects %}
            <div class="six columns">
              <table class="stretch">
                <tr>
                  <th>Subject</th>
                  <th>Credits</th>
                </tr>
                {% for item in subjects %}
                <tr>
                  <td>{{item.subject}}</td>
                  <td>{{item.credits|floatformat}} credit{{item.credits|pluralize}}</td>
                </tr>
                {% empty %}
                <tr>
                  <td>No subjects</td>
                  <td></td>
                </tr>
				{% endfor %}
              </table>
            </div>
            {% endwith %}
          </div>
          
          <hr class="inside">
          
          <div class="row">
            <div class="six columns phone-two">
              <h2>Reviews</h2>
            </div>
            <div class="six columns phone-two">
              <div class="rating">
              	{% get_stars profile.avg_rate %}
              </div>
            </div>
          </div>
            
        {% for review1, review2 in person.reviews_as_tutor.all|reviews_style %}
	          <div class="row clear">
	            <div class="six columns">
	              <div class="small rating">
	                {% get_stars review1.rate %}
	              </div>
	              
	              <h5>{{review1.created}}</h5>
	              <p>{{review1.text}}</p>
	            </div>
	            
	            <div class="six columns">
		            {% if review2 %}
		              <div class="small rating">
		                {% get_stars review2.rate %}
		              </div>
		              
		              <h5>{{review2.created}}</h5>
		              <p>{{review2.text}}</p>
		            {% endif %}
	            </div>
	          </div>
	      {% empty %}
	      		No reviews at moment.
          {% endfor %}
          
          {% comment %}
          <!-- ul class="pagination">
            <li class="unavailable"><a href="">&laquo;</a></li>
            <li class="current"><a href="">1</a></li>
            <li><a href="">2</a></li>
            <li><a href="">3</a></li>
            <li><a href="">4</a></li>
            <li class="unavailable"><a href="">&hellip;</a></li>
            <li><a href="">12</a></li>
            <li><a href="">13</a></li>
            <li><a href="">&raquo;</a></li>
          </ul -->
          {% endcomment %}
          
        </div>
        <div class="three columns action">
		  {% if owner %}
          <a href="{% url edit_tutor_profile %}" class="book-class">Edit profile</a>
		  {% else %}
          <a href="javascript:;" class="send-message" data-reveal-id="modal-message" onclick="view_modal_messages({{person.id}});">Send a Message</a>
          <a href="{% url book_class person.username %}" class="book-class">Book a Class</a>
          <a id="favorite-tutor" href="javascript:;" class="favorite">{% if person|is_favorite:user %}Remove favorite{% else %}Add favorite{% endif %}</a>
          <a href="{% url report person.username %}" class="report">Report</a>
			<script type="text/javascript">
				$('#favorite-tutor').click(function(){
					$.get('{% url favorite person.id %}', function(response){
						$('#favorite-tutor').html(response);
					});
				});
			</script>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
 
  {% include 'profile/fragments/_modal_messages.html' %}
  {% if profile.video %}
  {% include 'profile/fragments/_modal_video.html' %}
  {% endif %}
   
  <div id="view-upload" class="reveal-modal">
    <a class="close-reveal-modal">&#215;</a>
  </div>
{% endblock %}